{"openapi":"3.1.0","info":{"title":"Bike Connect Backend API","description":"APIs for cyclist discovery, messaging, and group rides. Designed to match the React frontend API client.","version":"1.0.0"},"paths":{"/auth/register":{"post":{"tags":["Auth"],"summary":"Register a new user","description":"Creates a new user account and a default profile row.","operationId":"auth_register","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterRequest"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MeResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/login":{"post":{"tags":["Auth"],"summary":"Login","description":"Validates credentials and returns an access token for Authorization: Bearer usage.","operationId":"auth_login","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/me":{"get":{"tags":["Profiles"],"summary":"Get current user","description":"Returns the authenticated user's basic identity (used by the frontend AuthContext).","operationId":"me_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MeResponse"}}}}},"security":[{"HTTPBearer":[]}]}},"/profiles/{user_id}":{"get":{"tags":["Profiles"],"summary":"Get a user profile","description":"Returns profile info for the given user id.","operationId":"profiles_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProfileResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/profiles/me":{"put":{"tags":["Profiles"],"summary":"Update current user's profile","description":"Updates the authenticated user's profile fields.","operationId":"profiles_update_me","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProfileUpdateRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProfileResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/location":{"post":{"tags":["Location & Nearby"],"summary":"Update current user's location","description":"Stores the authenticated user's latest location for nearby search.","operationId":"location_update","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LocationUpdateRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/nearby":{"get":{"tags":["Location & Nearby"],"summary":"Search nearby cyclists","description":"Returns cyclists within radius_km of the provided lat/lng. Requires auth.","operationId":"nearby_search","security":[{"HTTPBearer":[]}],"parameters":[{"name":"lat","in":"query","required":true,"schema":{"type":"number","description":"Latitude","title":"Lat"},"description":"Latitude"},{"name":"lng","in":"query","required":true,"schema":{"type":"number","description":"Longitude","title":"Lng"},"description":"Longitude"},{"name":"radius_km","in":"query","required":false,"schema":{"type":"number","maximum":200,"exclusiveMinimum":0,"description":"Search radius in kilometers","default":5.0,"title":"Radius Km"},"description":"Search radius in kilometers"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NearbyResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/conversations":{"get":{"tags":["Messaging"],"summary":"List conversations","description":"Returns conversations for the current user with a title and last message preview.","operationId":"conversations_list","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConversationsResponse"}}}}},"security":[{"HTTPBearer":[]}]}},"/conversations/{conversation_id}/messages":{"get":{"tags":["Messaging"],"summary":"Get messages","description":"Returns messages for a conversation, with is_mine flags used by the frontend UI.","operationId":"conversations_messages_list","security":[{"HTTPBearer":[]}],"parameters":[{"name":"conversation_id","in":"path","required":true,"schema":{"type":"string","title":"Conversation Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessagesResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Messaging"],"summary":"Send a message","description":"Adds a message to the conversation. Requires participant membership.","operationId":"conversations_messages_send","security":[{"HTTPBearer":[]}],"parameters":[{"name":"conversation_id","in":"path","required":true,"schema":{"type":"string","title":"Conversation Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SendMessageRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageItem"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/rides":{"get":{"tags":["Rides"],"summary":"List rides","description":"Returns recent rides (group ride events).","operationId":"rides_list","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RidesResponse"}}}}},"security":[{"HTTPBearer":[]}]},"post":{"tags":["Rides"],"summary":"Create a ride","description":"Creates a new group ride event owned by the current user.","operationId":"rides_create","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RideCreateRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RideResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/rides/{ride_id}":{"get":{"tags":["Rides"],"summary":"Get a ride","description":"Get ride details by id.","operationId":"rides_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"ride_id","in":"path","required":true,"schema":{"type":"string","title":"Ride Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RideResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"tags":["System"],"summary":"Health check","description":"Basic service health check.","operationId":"health_check","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/health/db":{"get":{"tags":["System"],"summary":"Database connectivity check","description":"Verifies the API can connect to PostgreSQL (SELECT 1).","operationId":"health_db","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"ConversationItem":{"properties":{"id":{"type":"string","title":"Id","description":"Conversation id."},"title":{"type":"string","title":"Title","description":"Conversation title shown by frontend (usually other user's display name)."},"last_message":{"type":"string","title":"Last Message","description":"Last message preview.","default":""}},"type":"object","required":["id","title"],"title":"ConversationItem"},"ConversationsResponse":{"properties":{"items":{"items":{"$ref":"#/components/schemas/ConversationItem"},"type":"array","title":"Items","description":"List of conversations."}},"type":"object","title":"ConversationsResponse"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"LocationUpdateRequest":{"properties":{"lat":{"type":"number","maximum":90.0,"minimum":-90.0,"title":"Lat","description":"Latitude."},"lng":{"type":"number","maximum":180.0,"minimum":-180.0,"title":"Lng","description":"Longitude."}},"type":"object","required":["lat","lng"],"title":"LocationUpdateRequest"},"LoginRequest":{"properties":{"email":{"type":"string","title":"Email","description":"User email."},"password":{"type":"string","title":"Password","description":"User password."}},"type":"object","required":["email","password"],"title":"LoginRequest"},"MeResponse":{"properties":{"id":{"type":"string","title":"Id","description":"User ID."},"email":{"type":"string","title":"Email","description":"Email."},"display_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Display Name","description":"Display name."}},"type":"object","required":["id","email"],"title":"MeResponse"},"MessageItem":{"properties":{"id":{"type":"string","title":"Id","description":"Message id."},"text":{"type":"string","title":"Text","description":"Message body."},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"Timestamp (UTC)."},"is_mine":{"type":"boolean","title":"Is Mine","description":"True if the message was sent by the current user."}},"type":"object","required":["id","text","created_at","is_mine"],"title":"MessageItem"},"MessagesResponse":{"properties":{"items":{"items":{"$ref":"#/components/schemas/MessageItem"},"type":"array","title":"Items","description":"Messages."}},"type":"object","title":"MessagesResponse"},"NearbyResponse":{"properties":{"items":{"items":{"$ref":"#/components/schemas/NearbyUserItem"},"type":"array","title":"Items","description":"Nearby users."}},"type":"object","title":"NearbyResponse"},"NearbyUserItem":{"properties":{"user_id":{"type":"string","title":"User Id","description":"Nearby user id."},"display_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Display Name","description":"Display name."},"email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Email","description":"Email (may be omitted in production)."},"pace":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Pace","description":"Pace preference."},"bike_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Bike Type","description":"Bike type."},"distance_km":{"type":"number","title":"Distance Km","description":"Approximate distance in kilometers."}},"type":"object","required":["user_id","distance_km"],"title":"NearbyUserItem"},"ProfileResponse":{"properties":{"user_id":{"type":"string","title":"User Id","description":"User ID."},"display_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Display Name","description":"Display name."},"bio":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Bio","description":"Bio."},"pace":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Pace","description":"Pace preference."},"bike_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Bike Type","description":"Bike type."},"looking_for":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Looking For","description":"What the user is looking for."},"home_base":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Home Base","description":"Approximate home base."},"updated_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Updated At","description":"Last update time (UTC)."}},"type":"object","required":["user_id"],"title":"ProfileResponse"},"ProfileUpdateRequest":{"properties":{"display_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Display Name","description":"Display name."},"bio":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Bio","description":"Bio."},"pace":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Pace","description":"Pace preference."},"bike_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Bike Type","description":"Bike type."},"looking_for":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Looking For","description":"What the user is looking for."},"home_base":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Home Base","description":"Approximate home base."}},"type":"object","title":"ProfileUpdateRequest"},"RegisterRequest":{"properties":{"email":{"type":"string","title":"Email","description":"User email (unique)."},"password":{"type":"string","minLength":6,"title":"Password","description":"User password (min 6 chars)."},"display_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Display Name","description":"Optional display name shown in the UI."}},"type":"object","required":["email","password"],"title":"RegisterRequest"},"RideCreateRequest":{"properties":{"title":{"type":"string","title":"Title","description":"Ride title."},"date":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Date","description":"Ride date 'YYYY-MM-DD'."},"time":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Time","description":"Ride time 'HH:MM'."},"pace":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Pace","description":"Pace."},"distance_km":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Distance Km","description":"Distance in km."},"start":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Start","description":"Start location."},"notes":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Notes","description":"Extra notes."}},"type":"object","required":["title"],"title":"RideCreateRequest"},"RideResponse":{"properties":{"id":{"type":"string","title":"Id","description":"Ride id."},"title":{"type":"string","title":"Title","description":"Ride title."},"date":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Date","description":"Ride date."},"time":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Time","description":"Ride time."},"pace":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Pace","description":"Pace."},"distance_km":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Distance Km","description":"Distance in km."},"start":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Start","description":"Start location."},"notes":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Notes","description":"Notes."},"creator_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Creator Id","description":"Creator user id."}},"type":"object","required":["id","title"],"title":"RideResponse"},"RidesResponse":{"properties":{"items":{"items":{"$ref":"#/components/schemas/RideResponse"},"type":"array","title":"Items","description":"Ride list."}},"type":"object","title":"RidesResponse"},"SendMessageRequest":{"properties":{"text":{"type":"string","minLength":1,"title":"Text","description":"Message text."}},"type":"object","required":["text"],"title":"SendMessageRequest"},"TokenResponse":{"properties":{"access_token":{"type":"string","title":"Access Token","description":"JWT access token to be used as 'Authorization: Bearer <token>'."},"token_type":{"type":"string","title":"Token Type","description":"Token type (always 'bearer').","default":"bearer"}},"type":"object","required":["access_token"],"title":"TokenResponse"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"HTTPBearer":{"type":"http","scheme":"bearer"}}},"tags":[{"name":"Auth","description":"Authentication endpoints (register/login)."},{"name":"Profiles","description":"User identity and profile management."},{"name":"Location & Nearby","description":"Location updates and nearby cyclist search."},{"name":"Messaging","description":"Conversation and messaging APIs."},{"name":"Rides","description":"Group ride (event) creation and listing."},{"name":"System","description":"Health and diagnostics."}]}